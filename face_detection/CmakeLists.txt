cmake_minimum_required(VERSION 3.10)
project(FaceRecognition_Core)

set(CMAKE_CXX_STANDARD 14)

# 1. 设置 OpenCV 的路径引导
# 告诉 CMake 去哪里找 OpenCVConfig.cmake
# 注意路径要指向包含 OpenCVConfig.cmake 的那个文件夹
set(OpenCV_DIR ${CMAKE_SOURCE_DIR}/3rdparty/opencv/lib/cmake/opencv4)

# 2. 查找 OpenCV 包 (必须放在 set OpenCV_DIR 之后)
# STATIC 表示我们要查找静态库
find_package(OpenCV REQUIRED)

# 3. 打印一下日志，确保找到了
message(STATUS "OpenCV library status:")
message(STATUS "    version: ${OpenCV_VERSION}")
message(STATUS "    libraries: ${OpenCV_LIBS}")
message(STATUS "    include path: ${OpenCV_INCLUDE_DIRS}")

# 4. RKNN 配置 (保持不变)
include_directories(${CMAKE_SOURCE_DIR}/3rdparty/rknn/include)
link_directories(${CMAKE_SOURCE_DIR}/3rdparty/rknn/lib)

# 5. 生成库
add_library(face_engine SHARED src/face_engine.cpp)

# 6. 链接库
# ${OpenCV_LIBS} 会自动包含 core, imgproc, imgcodecs 以及它们依赖的系统库(zlib, dl, pthread等)
target_link_libraries(face_engine
    rknnrt
    ${OpenCV_LIBS} 
)